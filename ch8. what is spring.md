# 8. 스프링이란 무엇인가?

## 8.1 스프링의 정의

- 자바 엔터프라이즈 개발을 편하게 해주는 오픈소스 경량급 애플리케이션 프레임워크
 
1) 애플리케이션 프레임워크
    - 일반적인 라이브러리/프레임워크는 특정 업무 분야나 한 가지 기술에 특화되었다. MVC 구조 (스트러츠), 로그 (JUnit), ORM (JPA)
    - 하지만 스프링은 전 영역을 포괄하는 범용적인 애플리케이션 프레임워크라는 특징이 있다.
    - 스프링의 기원은 로드 존슨의 J2EE 기술서적에 딸린 예제 코드였다.
    - 이 코드는 애플리케이션의 전 영역을 관통하는 일관된 프로그래밍 모델과 핵심 기술의 바탕을 제공해 주었다.

2) 경량급
    - 당시 EJB 의 무겁고 복잡한 기술이 존재했음.
    - EJB / 여타 프레임워크와 비교해서 불필요하게 무겁지 않다.
    - 가벼운 이유 : 코드에 불필요하게 등장하는 프레임워크 / 서버환경에 의존적인 부분을 제거했기 때문이다.
    - 스프링은 다른 프레임워크들과 기술 수준은 비슷하더라도 훨씬 빠르고 간편하게 작성 해줌으로 생산성과 품질면에서 유리함. = 경량급
3) 자바 엔터프라이브 개발을 편하게
    > 자바 엔터프라이즈 개발 : 자바를 이용한 서버측 개발
    > EX) EJB 목표
    > EJB를 사용하면 애플리케이션 작성을 편하게 할 수 있다. 로우레벨에서 트랜잭션이나 상태 관리, 멀티스레딩, 리소스 풀링과 같은 복잡한 로우레벨의 API 따위를
    > 이해하지 못하더라도 아무런 문제 없이 애플리케이션을 개발할 수 있다.

    > 편리한 애플리케이션 개발
    > 개발자가 복잡하고 실수하기 쉬운 로우레벨 기술에 많은 신경을 쓰지 않으면서도 핵심적인 요구사항(비즈니스 로직)을 효과적으로 구현하는 것

    - EJB 는 일정부분에서 서버 개발의 고민거리와 부담을 덜어줬으나 이 과정에서 더 큰 복잡함을 개발에 끌고오는 실수를 저질렀다. (비즈니스 로직과 기술의 혼재 같음)
    - 스프링은 개발자들이 비즈니스 로직에 더많은 관심과 시간을 쏟게 해준다.
    - 스프링이 주는 편리함 : 엔터프라이즈 개발의 기술적인 복잡함과 수고를 제거하지만 필연적으로 요구되는 기술적인 요구를 충족하고 개발을 복잡하게 만들지 않는다.
4) 오픈소스
    - 소스가 모두에게 공개되고 특별한 라이선스를 취득할 필요 없이 얼마든지 가져다 쓸 수 있다. [SPRING GITHUB](https://github.com/spring-projects/spring-framework)
    - 스프링에 적용된 오픈소스 라이선스는 비교적 제약이 적고 사용하기 편한 - 아파치 라이선스 버전 2.0 - [SPRING LICENSE](https://github.com/spring-projects/spring-framework/blob/master/src/docs/dist/license.txt), [아파치 라이선스 버전](https://ko.wikipedia.org/wiki/%EC%95%84%ED%8C%8C%EC%B9%98_%EB%9D%BC%EC%9D%B4%EC%84%A0%EC%8A%A4)
    - 스프링은 오픈소스 개발 모델을 사용하는 전 세계 개발자의 참여를 통해 발전해왔다. (많은 이슈 해결 / 안정성)
    - 단점 : 오픈소스는 개인화 되어 있어 안정적인 개발이 계속될지가 불확실했다.
    - 극복 : 프레임워크 사용자에게 지속적인 신뢰를 줄 수 있도록 책임을 가진 전문 기업을 만들었다.
    - History : Spring source(Spring 이름 변경) -> VMWare -> Pivotal     [Spring(history)](https://en.wikipedia.org/wiki/Spring_(company))

## 8.2 스프링의 목적

- 원래 서버 개발이란 편하지 않다.

### 8.2.1 엔터프라이즈 개발의 복잡함

- 2000년대 초반에는 서버 개발이 실패하는 이유에 대한 논의가 많았다. 그 중 대표적인 이유는 '서버개발이 복잡해서'였다.

1) 복잡함의 근복적인 이유

    - 첫 번째는 기술적인 제약조건과 요구사항이 늘어가기 때문이다.
        - 서버는 많은 사용자의 요청을 동시에 처리해야 한다. (효율적인 자원의 공유와 분배)
        - 핵심 정보를 처리 한다. (뛰어난 보안/안정성/확장성 요구)
        - 복잡한 시스템과 다중 데이터베이스 (분산 트랜잭션 지원)
        - 이것들은 오로지 개발자의 몫

    - 두 번째는 엔터프라이즈 애플리케이션이 구현해야 할 핵심적인 비즈니스 로직의 복잡함이 증가하기 때문이다.
        - 서버에 업무 의존도가 높아짐에 따라 다양하고 복잡한 업무가 대두
        - 빠른 변화에 맞춰 애플리케이션이 자주 바뀌는 시대적인 상황

2) 복잡함을 가중시키는 원인

    - 서버 개발이 실패하는 이유 : 비즈니스 로직과 기술적인 부분이 혼재되어 있다. ->
    - 세부 요소가 이해하기 힘든 방식으로 얽혀있다. -> 쉽게 다루기 어렵다. -> 잘못 손댔다가  엉망이 되기 쉽다.

### 8.2.2 복잡함을 해결하려는 도전

1) 제거될 수 없는 근본적인 복잡함

    - 근본적인 서버개발의 복잡함은 제거 대상이 아니라 효과적으로 상대할 전략과 기법이 필요하다.
    - 가장 중요한 것은 비즈니스 로직과 기술적인 부분을 분리하는 것이다.

2) 실패현 해결책 : EJB

    - EJB의 기본전략도 이 두가지를 분리해 내는 것이었다.
    - 일부 목표(선언적 트랜잭션/보안, 컴포넌트 단위 배츠 등)는 달성 했지만, 환경과 스펙에 종속되는 코드를 만들어야 하는 부담감을 가지게 되었다.(특정 인터페이스를 구현, 특정 클래스를 상속 등)
    - 복잡함을 덜려다 더 큰 복잡함이 들어왔다. (의존성)

3) 비침투적인 방식을 통한 효과적인 해결책 : 스프링

    - EJB 의 실패를 교훈삼아 출발했다.
    - EJB 의 문제 (의존성) 을 침투적인 기술이라고 했고 이는 복잡함을 가중시키는 원인이라고 생각했다.
    - 비침투적인 기술(기술의 적용 사실이 코드에 직접 반영되지 않음)이라는 전략을 선택해 비즈니스로직과 기술코드를 깔끔하게 분리했다.

### 8.2.3 복잡함을 상대하는 스프링의 전략

    - 비즈니스 로직을 담은 애플리케이션 코드와 서버 기술을 처리하는 코드를 분리시키는 것

1) 기술적 복잡함을 상대하는 전략
    - 첫 번째 문제 : 기술에 대한 접근 방식이 일관성이 없고, 특정 환경에 종속적이다.
        - 일관성 없는 기술과 서버환경의 변화에 대한 서비스 추상화
            - 로우 레벨의 기술 구현 부분과 기술을 사용하는 인터페이스를 분리, 환경과 세부기술에 독립적인 접근 인터페이스를 제공
    - 두 번째 문제 : 기술적인 처리를 담당하는 코드가 성격이 다른 코드에 섞여서 등장한다.(비즈니스 로직 전후의 트랜잭션, 보안/감사, 로깅 등)
        - 애플리케이션 로직과 기술 관련 코드를 깔끔하게 분리 후 별도의 모듈로 관리할 수 있는 AOP

2) 비즈니스와 애플리케이션 로직의 복잡함을 상대하는 전략
    - 스프링은 애플리케이션 로직에서 객체지향 언어의 장점을 제대로 살리지 못하게 방해했던 요소들을 제거하도록 도와준다.

3) 핵심도구: 객체지향과 DI
    - 스프링의 기본 전략은 객체지향에 충실한 설계가 가능하도록 단순한 오브젝트로 개발하고, 객체지향 설계 기법을 적용할 수 있는 구조를 만들기 위해 DI를 적용
    - DI 란 유연하게 확장할 수 있는 오브젝트 설계를 하다보면 자연스럽게 적용되는 객체지향 프로그래밍 기법
    - 그래서 DI를 잘 따르다 보면 객체지향 설계의 원칙을 잘 따르고 그 장점을 살린 설계가 가능
    - 스프링은 '거들 뿐'

## 8.3 POJO 프로그래밍

    - 스프링 핵심 개발자들이 말한 스프링의 정수 '엔터프라이즈 서비스 기능을 POJO에 제공하는 것'
    - 스프링의 목표 '분리됐지만 반드시 필요한 엔터프라이즈 서비스 기술을 POJO 방식으로 개발된 애플리케이션 핵심 로직을 담은 코드에 제공한다.'

### 8.3.1 스프링의 핵심 : POJO

    - 스프링은 'POJO 애플리케이션 코드'와 관계 정보를 가진 '설계 정보'로 구분된다. (유연한 오브젝트들을 외부에서 다이내믹하게 설정해준다.)

### 8.3.2 POJO 란 무엇인가?

    - 간단한 자바 오브젝트라는 마틴 파울러가 평범한걸 있어보이게 하고 싶어 만든 이름 (Plain Old Java Object) [예제 POJO](https://en.wikipedia.org/wiki/Plain_old_Java_object)

### 8.3.3 POJO 의 조건

1) 특정 규약에 종속되지 않는다.
    - 자바 언어와 꼭 필요한 API 외에는 종속되지 않아야 한다. 특정 규약을 따라 비즈니스 컴포넌트를 만들면 POJO 가 아니다.

2) 특정 환경에 종속되지 않는다.
    - EJB 3 에서는 JNDI 를 통해 의존 오브젝트정보를 가져와야한다. -> JNDI 가 없는 환경에서 그대로 사용하기 어렵다.
    - 특정 환경이 의존 대상 검색 방식에 종속적이라면 POJO 가 아니다. (환경에 독립적이어야 한다.)

> 진정한 POJO 란 ? 객체지향적 원리에 충실하면서 환경과 기술에 종속되지 않고 필요에 따라 재활용될 수 있는 방식으로 설계된 오브젝트
> POJO 프로그래밍이란 ? POJO 에 애플리케이션의 핵심 로직과 기능을 담아 설계하고 개발하는 방법

### 8.3.4 POJO 의 장점

    - 기술과 환경에 종속되지 않는 깔끔한 코드이므로 유지보수하기 쉽다.
    - 자동화된 테스트에 유리하다. (환경의 제약이 없다)
    - 객체지향적인 설계를 자유롭게 적용할 수 있다.
    - 왜 객체지향 설계를 해야하는가?
    - 로드 존슨은 대규모 자바 엔터프라이즈 시스템을 개발해온 수많은 경험을 자바언어의 객체지향적인 설계와 구현 방식이 어떤 새로운 기술/환경/툴 보다 프로젝트를 성공시키는 중요한 요소라고 생각했기 때문이다.

### 8.3.5 POJO 프레임워크

    - POJO 를 이용한 엔터프라이즈 개발을 목적으로 하는 프레임워크
    - '핵심 로직'을 객체지향적인 POJO 를 기반으로 깔끔하게 구현하고 엔터프라이즈 환경의 '각종 서비스와 기술'을 POJO 방식의 코드로 적용할 수 있음.
    - 스프링(POJO 프레임워크) 는 개발자들이 복잡한 엔터프라이즈 기술보다 객체지향적인 설계와 개발 원리에 집중할 수 있는 기회를 준다.

## 8.4 스프링의 기술

    - 스프링은 POJO 프로그래밍을 순쉽게 하도록 Ioc/DI, AOP, PSA 가능 기술을 제공한다.
    - 하지만 이 3가지 기능도 객체지향의 원리를 충실 적용한 결과이다. 이미 만들어진 기술 뿐 아니라 새로운 기술에도 이러한 기술을 접목시켜 사용할 줄 알아야 한다.

### 8.4.1 제어의 역전 (IoC) / 의존관계 주입 (DI)

 - 왜 두개의 오브젝트를 분리해서 만들고 인터페이스로 느슨하게 연결한 후, 외부에서 DI 를 지정할까? 유연한 확장이 가능하게 하기 위해서 이다.
 - A -> B 관계에서 유연한 확장의 장점은 B는 유연한 확장을 할 수 있고, A 는 변경없이 재사용 가능하다는 점이다.

1) DI의 활용 방법
    - 핵심기능의 변경
        - 전략 패턴 / JDBC -> JPA -> 하이버네이트 -> MyBatis 등..
    - 핵심기능의 동적인 변경
        - 런타임시에 동적으로 의존 대상을 다이내믹하게 변경할 수 있다.
    - 부가기능의 추가
        - 데코레이터 패턴 / 핵심기능과 클라이언트에 영향을 주지 않고 부가기능을 추가할 수 있다.
    - 인터페이스의 변경
        - 어댑터 패턴 / PSA
    - 프록시
        - 지연된 로딩
    - 템플릿과 콜백
        - 고정적인 작업 흐름과 자주 바뀌는 부분은 분리해서 템플릿/콜백으로 만들고 이를 DI 한다.
    - 싱글톤과 오브젝트 스코프
        - 기본적으로 싱글톤 스코프를 사용하여 상태를 갖지 않도록 만든 오브젝트가 동시에 여러 스레드의 요청을 처리하도록 한다.
    - 테스트
        - 테스트 대상의 의존 오브젝트를 목 오브젝트로 대체하면 유용하다.

### 8.4.2 애스팩트 지향 프로그래밍 (AOP)

1) AOP 적용 기법
    - 첫 번째는 스프링과 같이 다이내믹 프록시를 사용하는 방법이다.
        - 데코레이터 패턴의 응용 - 다이내믹 프록시를 이용하는 AOP
    - 두 번째는 자바 언어의 한계를 넘어서는 언어의 확장을 이용하는 방법이다.
        - AspectJ 를 이용하는 AOP

2) AOP 적용 단계
    - 적용 1단계 : 미리 준비된 AOP 이용
        - 쉬운 것 부터 트랜잭션 부터 도입해 AOP의 특성과 원리를 이해하자
    - 적용 2단계 : 전담팀을 통한 정책 AOP 적용
    - 적용 3단계 : AOP의 자유로운 이용
    
3) 포터블 서비스 추상화
 

 

